<h2>Pacientul {{pacient.original.name + ' ' +
	pacient.original.surname}}</h2>
<uib-accordion close-others="oneAtATime" class='col-sm-12'>
<label><p ng-if="hasChanged"
		style="color: red; font-size: 150%;">Schimbari efectuate dar inca
		nesalvate!</p></label>
<div uib-accordion-group class="panel-default" is-open="status.open">
	<uib-accordion-heading> Detalii <i
		class="pull-right glyphicon"
		ng-class="{'glyphicon-chevron-down': status.open, 'glyphicon-chevron-right': !status.open}"></i>
	</uib-accordion-heading>
	<div ng-if="!pacient.editMode">
		<div class="row">
			<div class="col-sm-4">
				<label class="form-control" ng-class="{'input-modified': pacient.edit.name !== pacient.original.name}">Nume: {{pacient.edit.name}}</label>
			</div>
			<div class="col-sm-4">
				<label class="form-control" ng-class="{'input-modified': pacient.edit.surname !== pacient.original.surname}">Prenume:
					{{pacient.edit.surname}}</label>
			</div>
			<div class="col-sm-4">
				<label class="form-control" ng-class="{'input-modified': pacient.edit.pacientDetailsDto.phone && pacient.edit.pacientDetailsDto.phone !== pacient.original.pacientDetailsDto.phone}">Telefon:
					{{pacient.edit.pacientDetailsDto.phone}}</label>
			</div>
		</div>
		<br>
		<div class="row">
			<div class="col-sm-4">
				<label class="form-control" ng-class="{'input-modified': pacient.edit.pacientDetailsDto.address && pacient.edit.pacientDetailsDto.address !== pacient.original.pacientDetailsDto.address}">Adresa:
					{{pacient.edit.pacientDetailsDto.address}}</label>
			</div>
			<div class="col-sm-4">
				<label class="form-control" ng-class="{'input-modified': pacient.edit.pacientDetailsDto.zipCode && pacient.edit.pacientDetailsDto.zipCode !== pacient.original.pacientDetailsDto.zipCode}">Zip Code:
					{{pacient.edit.pacientDetailsDto.zipCode}}</label>
			</div>
			<div class="col-sm-4">
				<label class="form-control" ng-class="{'input-modified': pacient.edit.doctor && pacient.edit.doctor.doctorId !== pacient.original.doctor.doctorId}">Doctor asignat:
					{{pacient.edit.doctor.name + ' ' + pacient.edit.doctor.surname}}</label>
			</div>
		</div>
		<br>
		<div class="row">
			<div class="col-sm-4">
				<label class="form-control" ng-class="{'input-modified': pacient.edit.pacientDetailsDto.cnp && pacient.edit.pacientDetailsDto.cnp !== pacient.original.pacientDetailsDto.cnp}">Cnp: {{pacient.edit.pacientDetailsDto.cnp}}</label>
			</div>
			<div class="col-sm-4">
				<label class="form-control" ng-class="{'input-modified': pacient.edit.pacientDetailsDto.birthdate && (pacient.edit.pacientDetailsDto.birthdate | date:'dd-MM-yyyy') !== (pacient.original.pacientDetailsDto.birthdate | date:'dd-MM-yyyy')}">Data nasterii: {{pacient.edit.pacientDetailsDto.birthdate | date:'dd-MM-yyyy'}}</label>
			</div>
			<div class="col-sm-4">
				<label class="form-control" ng-class="{'input-modified': pacient.edit.pacientDetailsDto.sex && pacient.edit.pacientDetailsDto.sex !== pacient.original.pacientDetailsDto.sex}">Sex: {{pacient.edit.pacientDetailsDto.sex}}</label>
			</div>
		</div>
		<br>
	</div>
	<div ng-if="pacient.editMode">
		<div class="row">
			<div class="col-sm-4">
				<input type="text" ng-model="pacient.edit.name" class="form-control" ng-class="{'input-modified': pacient.edit.name !== pacient.original.name}"
					placeholder="Nume">
			</div>
			<div class="col-sm-4">
				<input type="text" ng-model="pacient.edit.surname" ng-class="{'input-modified': pacient.edit.surname !== pacient.original.surname}"
					class="form-control" placeholder="Prenume">
			</div>
			<div class="col-sm-4">
				<input type="text" ng-model="pacient.edit.pacientDetailsDto.phone" ng-class="{'input-modified': pacient.edit.pacientDetailsDto.phone && pacient.edit.pacientDetailsDto.phone !== pacient.original.pacientDetailsDto.phone}"
					class="form-control" placeholder="Telefon">
			</div>
		</div>
		<br>
		<div class="row">
			<div class="col-sm-4">
				<textarea ng-model="pacient.edit.pacientDetailsDto.address" class="form-control" ng-class="{'input-modified': pacient.edit.pacientDetailsDto.address && pacient.edit.pacientDetailsDto.address !== pacient.original.pacientDetailsDto.address}"
					style="max-width: 100%;" placeholder="Adresa"></textarea>
			</div>
			<div class="col-sm-4">
				<input type="text" ng-model="pacient.edit.pacientDetailsDto.zipCode" ng-class="{'input-modified': pacient.edit.pacientDetailsDto.zipCode && pacient.edit.pacientDetailsDto.zipCode !== pacient.original.pacientDetailsDto.zipCode}"
					class="form-control" placeholder="Zip Code">
			</div>
			<div class="col-sm-4">
				<select type="text" ng-options="doc.name+' '+doc.surname for doc in doctorsList track by doc.doctorId" 
				ng-model="pacient.edit.doctor" 
				ng-class="{'input-modified': pacient.edit.doctor && pacient.edit.doctor.doctorId !== pacient.original.doctor.doctorId}"
					class="form-control">
					</select>
			</div> 
		</div>
		<br>
		<div class="row">
			<div class="col-sm-4">
				<input type="text" ng-model="pacient.edit.pacientDetailsDto.cnp" ng-class="{'input-modified': pacient.edit.pacientDetailsDto.cnp && pacient.edit.pacientDetailsDto.cnp !== pacient.original.pacientDetailsDto.cnp}" class="form-control"
					maxlength="13" placeholder="CNP">
			</div>
			<div class="col-sm-4">
				<p class="input-group">
	          		<input type="text" popup-placement="bottom" readonly class="form-control" ng-class="{'input-modified': pacient.edit.pacientDetailsDto.birthdate && (pacient.edit.pacientDetailsDto.birthdate | date:'dd-MM-yyyy') !== (pacient.original.pacientDetailsDto.birthdate | date:'dd-MM-yyyy')}" uib-datepicker-popup="{{'dd-MM-yyyy'}}" ng-model="pacient.edit.pacientDetailsDto.birthdate" is-open="birthDateOpened" datepicker-options="dateOptions" ng-required="true" close-text="Close" alt-input-formats="altInputFormats">
	          			<span class="input-group-btn">
	            		<button type="button" class="btn btn-default" ng-click="birthDateOpened = true;"><i class="glyphicon glyphicon-calendar"></i></button>
	         		 </span>
	        	</p>
			</div>
			
			<div class="col-sm-4">
				<select class="form-control" ng-model="pacient.edit.pacientDetailsDto.sex" ng-class="{'input-modified': pacient.edit.pacientDetailsDto.sex && pacient.edit.pacientDetailsDto.sex !== pacient.original.pacientDetailsDto.sex}">
					<option value="M">M</option>
					<option value="F">F</option>
				</select>
			</div>
		</div>
	</div>
	<button ng-if="!pacient.editMode" ng-click="pacient.editMode = true"
		style="float: right;">
		<i class="glyphicon glyphicon-pencil" aria-hidden="true"></i>
	</button>
	<button ng-if="pacient.editMode" ng-click="undoPacientDetailsChanges();pacient.editMode = false;"
		style="float: right;">
		<img src="shared/img/Undo.png">
	</button>
	<button ng-if="pacient.editMode" ng-click="saveEditPacient(pacient)"
		style="float: right;">
		<i class="glyphicon glyphicon-floppy-saved" aria-hidden="true"></i>
	</button>
</div>
<div uib-accordion-group class="panel-default" is-open="status.openDet">
<label><p ng-if="changesInConsultations"
		style="color: red; font-size: 150%;"><i class="glyphicon glyphicon-warning-sign"></i></p></label>
	<button style="float: left; width: 20%" ng-click="addConsult();" class="form-control"><i class="glyphicon glyphicon-plus"></i> Adauga consultatie</button>
	<uib-accordion-heading>Consultatii <span
		class="badge">{{pacient.edit.consultations.length}}</span> </a> <i
		class="pull-right glyphicon"
		ng-class="{'glyphicon-chevron-down': status.openDet, 'glyphicon-chevron-right': !status.openDet}"></i>
	</uib-accordion-heading>
	<table class="table table-striped scrollTable">
		<thead>
			<tr>
				<th>Diagnostic</th>
				<th>Observatii</th>
				<th>Pret</th>
				<th>Date</th>
				<th>
			</tr>
		</thead>
		<tbody>
			<tr ng-repeat="cons in pacient.edit.consultations">
				<td ng-if="!cons.editMode" style="text-align: left;">{{cons.edit.diagnostic}}</td>
				<td style="text-align: left;" ng-if="cons.editMode"><input
					class="form-control" type="text" ng-model="cons.edit.diagnostic"></td>
				<td ng-if="!cons.editMode" style="text-align: left;">{{cons.edit.observation}}</td>
				<td style="text-align: left;" ng-if="cons.editMode"><input
					class="form-control" type="text" ng-model="cons.edit.observation"></td>
				<td ng-if="!cons.editMode" style="text-align: left;">{{cons.edit.price}} RON</td>
				<td style="text-align: left;" ng-if="cons.editMode"><input
					class="form-control" type="text" ng-model="cons.edit.price"></td>
				<td ng-if="!cons.editMode" style="text-align: left;">{{cons.edit.consultationTime | date:'medium'}}</td>
				<td style="text-align: left;"><button ng-if="!cons.editMode"
						ng-click="cons.editMode = true">
						<i class="glyphicon glyphicon-pencil" aria-hidden="true"></i>
					</button>
					<button ng-if="cons.editMode" ng-click="cons.editMode = fasle;saveConsult(cons)">
						<i class="glyphicon glyphicon-floppy-saved" aria-hidden="true"></i>
					</button>
					<button ng-if="!cons.editMode" ng-click="deleteConsult($index)">
						<i class="glyphicon glyphicon-trash" aria-hidden="true"></i>
					</button>
					<button ng-if="cons.editMode" ng-click="cons.editMode = false; undoPacientConsultChanges(cons);">
						<img src="shared/img/Undo.png">
					</button></td>
			</tr>
		</tbody>
	</table>
</div>
<div uib-accordion-group class="panel-default" is-open="status.openCh">
	<uib-accordion-heading>Chestionar <i
		class="pull-right glyphicon"
		ng-class="{'glyphicon-chevron-down': status.openCh, 'glyphicon-chevron-right': !status.openCh}"></i>
	</uib-accordion-heading>
	<strong>Chestionar</strong>
</div>
<button type="button" ng-disabled="!hasChanged"
	class="btn btn-default btn-sm" ng-click="saveChangesDb(pacient);">Salveaza
	schimbari</button>
<button type="button" class="btn btn-default btn-sm"
	ng-disabled="!hasChanged" ng-click="resetDefault();">Reset</button>
</uib-accordion>